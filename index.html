<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Read and Write CSV on the Web (CSVW) Tables and Metadata • csvwr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Read and Write CSV on the Web (CSVW) Tables and Metadata">
<meta property="og:description" content="Provide functions for reading and writing CSVW - i.e. CSV tables and JSON metadata.
    The metadata helps interpret CSV by setting the types and variable names.">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">csvwr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.6.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/read-write-csvw.html">Read and Write CSVW in R</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Robsteranium/csvwr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="csv-on-the-web-r-package-csvwr-">CSV on the Web R Package (csvwr) <img src="reference/figures/logo.png" align="right" height="139"><a class="anchor" aria-label="anchor" href="#csv-on-the-web-r-package-csvwr-"></a>
</h1></div>

<p>Read and write csv tables annotated with metadata according to the “CSV on the Web” standard (CSVW).</p>
<p>The <a href="https://w3c.github.io/csvw/syntax/" class="external-link">csvw model for tabular data</a> describes how to annotate a group of csv tables to ensure they are interpreted correctly.</p>
<p>This package uses the <a href="https://w3c.github.io/csvw/metadata/" class="external-link">csvw metadata schema</a> to find tables, identify column names and cast values to the correct types.</p>
<p>The aim is to reduce the amount of manual work needed to parse and prepare data before it can be used in analysis.</p>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<div class="section level3">
<h3 id="reading-csvw">Reading CSVW<a class="anchor" aria-label="anchor" href="#reading-csvw"></a>
</h3>
<p>You can use <code>csvwr</code> to read a csv table with json annotations into a data frame:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://robsteranium.github.io/csvwr/" class="external-link">csvwr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Parse a csv table using json metadata :</span></span>
<span><span class="va">csvw</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/read_csvw.html">read_csvw</a></span><span class="op">(</span><span class="st">"data.csv"</span>, <span class="st">"metadata.json"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># To extract the parsed table (with syntactic variable names and typed-columns):</span></span>
<span><span class="va">csvw</span><span class="op">$</span><span class="va">tables</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">dataframe</span></span></code></pre></div>
<p>Alternatively, you can jump straight to the parsed table in one call:</p>
<pre><code><span><span class="fu"><a href="reference/read_csvw_dataframe.html">read_csvw_dataframe</a></span><span class="op">(</span><span class="st">"data.csv"</span>, <span class="st">"metadata.json"</span><span class="op">)</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="writing-csvw">Writing CSVW<a class="anchor" aria-label="anchor" href="#writing-csvw"></a>
</h3>
<p>You can also prepare annotations for a data frame:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Given a data frame (saved as a csv)</span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>,<span class="st">"b"</span>,<span class="st">"c"</span><span class="op">)</span>, y<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">d</span>, <span class="st">"table.csv"</span>, row.names<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Derive a schema</span></span>
<span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/derive_table_schema.html">derive_table_schema</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create metadata (as a list)</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/create_metadata.html">create_metadata</a></span><span class="op">(</span>tables<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>url<span class="op">=</span><span class="st">"table.csv"</span>, tableSchema<span class="op">=</span><span class="va">s</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Serialise the metadata to JSON</span></span>
<span><span class="va">j</span> <span class="op">&lt;-</span> <span class="fu">jsonlite</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/jsonlite/man/fromJSON.html" class="external-link">toJSON</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Write the json to a file</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">j</span>, file<span class="op">=</span><span class="st">"metadata.json"</span><span class="op">)</span></span></code></pre></div>
<p>For a complete introduction to the library please see the <code><a href="articles/read-write-csvw.html">vignette("read-write-csvw")</a></code>.</p>
</div>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You’ll need to use devtools to install this package from github:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"Robsteranium/csvwr"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="contributing">Contributing<a class="anchor" aria-label="anchor" href="#contributing"></a>
</h2>
<div class="section level3">
<h3 id="roadmap">Roadmap<a class="anchor" aria-label="anchor" href="#roadmap"></a>
</h3>
<p>Broadly speaking, the objectives are as follows:</p>
<ul>
<li>parse csvw, creating dataframes with specified names and types (mostly implemented)</li>
<li>connecting associated csv tables and json files according to the conventions set out in the csvw standard (partly implemented)</li>
<li>support for validating a table according to a metadata document (a little implemented)</li>
<li>support for multiple tables (mostly implemented)</li>
<li>tools for writing csvw metadata, given an R data frame (partly implemented)</li>
<li>vignettes and documentation (mostly implemented)</li>
<li>scripts for running the most useful tools from the command line (not yet implemented)</li>
</ul>
<p>It’s not an urgent objective for the library to perform csv2rdf or csv2json translation although some support for csv2json is provided as this is used to test that the parsing is done correctly.</p>
<p>In terms of the csvw test cases provided by the standard, the following areas need to be addressed (in rough priority order):</p>
<ul>
<li>datatypes (most of simple datatypes and some complex ones are supported, but there are more types and constraints too)</li>
<li>validations (there are a lot of these 😊)</li>
<li>propagation of inherited properties</li>
<li>http retrieval (<code><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">readr::read_csv</a></code> (and indeed <code><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">utils::read.csv</a></code>) accepts URIs, but the spec also involves link, dialect, and content-type headers)</li>
<li>referential integrity (a foundation for this is in place)</li>
<li>json nesting</li>
</ul>
</div>
<div class="section level3">
<h3 id="testing">Testing<a class="anchor" aria-label="anchor" href="#testing"></a>
</h3>
<p>The project currently incorporates two main parts of the <a href="https://w3c.github.io/csvw/tests/" class="external-link">csvw test</a> suite:</p>
<ul>
<li><a href="https://github.com/Robsteranium/csvwr/blob/master/tests/testthat/test-csvw-parsing-json.R" class="external-link">Parsing with JSON output</a></li>
<li><a href="https://github.com/Robsteranium/csvwr/blob/master/tests/testthat/test-csvw-validation.R" class="external-link">Validation</a></li>
</ul>
<p>In each case, we’re running only that subset of test entries that can be expected to pass given that part of the standard that has thus far been implemented. Some entries will be skipped (either permanently or) while other priorities are implemented.</p>
<p>You can find out what needs to be implemented next by widening the subset to include the next entry.</p>
<p>During development, you may find it convenient to recreate one of the test entries for exploration. There is a convenience function in <a href="https://github.com/Robsteranium/csvwr/blob/master/tests/csvw-tests-helpers.R" class="external-link">tests/csvw-tests-helpers.R</a>. This isn’t exported by the package so you’ll need to evaluate it explicitly. You can then use it as follows:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">run_entry_in_dev</span><span class="op">(</span><span class="fl">16</span><span class="op">)</span> <span class="co"># index number in the list of entries</span></span>
<span><span class="fu">run_entry_in_dev</span><span class="op">(</span>id<span class="op">=</span><span class="st">"manifest-json#test023"</span><span class="op">)</span> <span class="co"># identifier for the test</span></span></code></pre></div>
<p>There are also some more <a href="https://github.com/Robsteranium/csvwr/blob/master/tests/testthat/test-parsing.R" class="external-link">in-depth unit tests</a> written for this library.</p>
</div>
<div class="section level3">
<h3 id="workflow">Workflow<a class="anchor" aria-label="anchor" href="#workflow"></a>
</h3>
<p>You can use <code>devtools::load_all()</code> (<code>CTRL + SHIFT + L</code> in RStudio) to load updates and <code><a href="https://testthat.r-lib.org/reference/test_package.html" class="external-link">testthat::test_local()</a></code> (<code>CTRL + SHIFT + T</code>) to run the tests.</p>
<p>In order to check the vignettes, you need to do <code>devtools::install(build_vignettes=T)</code>. Then you can open e.g. <code><a href="articles/read-write-csvw.html">vignette("read-write-csvw")</a></code>.</p>
</div>
</div>
<div class="section level2">
<h2 id="license">License<a class="anchor" aria-label="anchor" href="#license"></a>
</h2>
<p>GPL-3</p>
<p>To discuss other licensing terms, please <a href="mailto:csvw@infonomics.ltd.uk">get in contact</a>.</p>
</div>
<div class="section level2">
<h2 id="other-csvw-tools">Other CSVW tools<a class="anchor" aria-label="anchor" href="#other-csvw-tools"></a>
</h2>
<p>There’s another R implementation of csvw in the package <a href="https://github.com/davideceolin/rcsvw" class="external-link">rcsvw</a>.</p>
<p>If you’re interested in csvw more generally, then the <a href="https://github.com/ruby-rdf/rdf-tabular/" class="external-link">RDF::Tabular</a> ruby gem provides one of the more robust and comprehensive implementations, supporting both translation and validation.</p>
<p>If you’re specifically interested in validation, take a look at the <a href="https://theodi.org/" class="external-link">ODI</a>’s <a href="https://github.com/Data-Liberation-Front/csvlint.rb" class="external-link">csvlint</a> which implements csvw and also the <a href="https://okfn.org/" class="external-link">OKFN</a>’s <a href="https://specs.frictionlessdata.io/" class="external-link">frictionless data table schemas</a>.</p>
<p>If you want rdf translation, then you might like to check out <a href="https://www.swirrl.com/" class="external-link">Swirrl</a>’s <a href="https://github.com/Swirrl/csv2rdf/" class="external-link">csv2rdf</a> and also <a href="https://github.com/swirrl/table2qb" class="external-link">table2qb</a> which generates csvw annotations from csv files to describe <a href="https://www.w3.org/TR/vocab-data-cube/" class="external-link">RDF Data Cubes</a>.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=csvwr" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/Robsteranium/csvwr/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/Robsteranium/csvwr/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing csvwr</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>
<a href="http://infonomics.ltd.uk" class="external-link">Robin Gower</a> <br><small class="roles"> Maintainer </small>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/Robsteranium/csvwr/actions/workflows/r.yml" class="external-link"><img src="https://github.com/Robsteranium/csvwr/actions/workflows/r.yml/badge.svg" alt="build"></a></li>
<li><a href="https://github.com/Robsteranium/csvwr/actions/workflows/pkgdown.yml" class="external-link"><img src="https://github.com/Robsteranium/csvwr/actions/workflows/pkgdown.yml/badge.svg" alt="pkgdown"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="http://infonomics.ltd.uk" class="external-link">Robin Gower</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.5.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
